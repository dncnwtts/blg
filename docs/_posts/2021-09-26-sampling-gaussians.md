---
layout: post
title: "How do I sample from a Gaussian?"
author: "Duncan J. Watts"
categories: journal
tags: [documentation,sample]
<!--image: mountains.jpg-->
---


In Bayesian analysis, something you generally want to do is draw a random number from a distribution and then decide if it's a good fit or not. The first part is harder than it seems. (The second part is easier if you use Gibbs sampling, but that's for another time.)

In general, we have a problem that looks like
$$
\boldsymbol d=\mathsf A\boldsymbol x+\boldsymbol n
$$
where we observe a datastream $\boldsymbol d$ that is generated by some linear process $\mathsf A$ applied to model parameters $\boldsymbol x$, and a noise vector $\boldsymbol n$.

In order to make some sense out of the data, we need a statistical model for the data. We like to assume that the signals and noise are Gaussian distributed, $\boldsymbol x\sim\mathcal N(\boldsymbol\mu,\mathbf S)$ and $\boldsymbol n\sim\mathcal N(\boldsymbol 0,\mathsf N)$.

If we were frequentists, we would ask, "What is the probability of observing this data given a model?"

$$
P(\boldsymbol d\mid\boldsymbol x)=\mathcal N(\mathsf A\boldsymbol x,\mathsf N)
$$

In case this isn't super obvious, we can compute the mean and covariance by hand;
$$
\langle \boldsymbol d\rangle
=\langle\mathsf A\boldymbol x\rangle+\langle\boldsymbol n\rangle
=\mathsf A\boldsymbol x
$$
since we take $\boldsymbol x$ to be fixed.
$$
\mathsf D=\langle\boldsymbol d\boldsymbol d^T\rangle
-\langle\boldsymbol d\rangle\langle\boldsymbol d\rangle^T
= (\mathsf A\boldsymbol x)(\mathsf A\boldsymbol x)^T
+\langle\boldsymbol n\boldsymbol n^T\rangle-
(\mathsf A\boldsymbol x)(\mathsf A\boldsymbol x)^T
=\mathsf N
$$
